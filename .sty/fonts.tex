% Load OpenType fonts with dedicated packages whenever possibler (XeTeX on macOS
% cannot find fonts in the TEXMF tree by font family name, and loading fonts by
% file name requires specifying variants and features explicitly.)
%
% To find the file name of a font, look in
% `/usr/local/texlive/<version>/texmf-dist/fonts/opentype/public`'

\ifpdftex
    % New PX (serif)
    \usepackage{newpxtext}

    % New PX (math)
    \usepackage{newpxmath}
\else
    % TeX Gyre Pagella (serif)
    \usepackage{pagella-otf}

    % Fira Sans (sans-serif)
    % \usepackage{FiraSans} % commented for faster compilation

    % Fira Mono (monospace)
    \usepackage[scale=.8, nomap]{FiraMono}

    % -------------------------------------------------------------------------
    % Math

    % Load New Computer Modern as a backup for symbols not defined in Pagella
    \setmathfont{NewCMMath-Book.otf}

    % Load TeX Gyre Pagella as the main font
    \setmathfont{texgyrepagella-math.otf}[
        AutoFakeBold,
    ]

    % Load Asana Math for letter `f` only (it has better kerning)
    \setmathfont{Asana-Math.otf}[
        AutoFakeBold,
        range=\mitf,
    ]

    % Map letter `f` to `\mitf` in math mode
    \begingroup\lccode`~=`f \lowercase{\endgroup\def~}{\mitf}
    \mathcode`f="8000
    % From <https://tex.stackexchange.com/a/530981>

    % Load New Computer Modern for select symbols
    \setmathfont{NewCMMath-Book.otf}[ % use book weight
        AutoFakeBold,
        CharacterVariant=1, % variant empty set symbol
        range={\mathop,\mathbin,\mathrel,\sqrt,\mathcal,\varnothing},
    ]
\fi
