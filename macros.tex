% -----------------------------------------------------------------------------
% Math packages that needs to be loaded before fonts

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathtools}

% -----------------------------------------------------------------------------
% Fonts

% Computer Modern (default)
% \usepackage{amsfonts}
% \usepackage{amssymb}

% Palatino (New PX)
% \usepackage{newpxtext}
% \usepackage{newpxmath}

% Palatino (TeX Gyre Pagella with `unicode-math`)
% This combination supports italic and upright greek letters.
\usepackage[
    math-style=ISO, bold-style=ISO,
    mathrm=sym, mathit=sym, mathsf=sym, mathbf=sym, mathtt=sym,
    warnings-off={mathtools-colon,mathtools-overbracket},
]{unicode-math}
\usepackage[libertinus, math=+aalt]{pagella-otf}
% The font does not have `\setminus`, possibly a bug.
% See https://tex.stackexchange.com/a/140343
\AtBeginDocument{
    \renewcommand{\setminus}{\mathbin{\backslash}}%
}

% For other high-quality fonts with math support, see
% - the list of compatible fonts to `unicode-math` (check `README.md`)
% - https://wiki.carleton.edu/download/attachments/20155418/fontguide.pdf
% - https://tex.stackexchange.com/questions/425098/which-opentype-math-fonts-are-available

% Source Code Pro (monospace)
\usepackage[scale=.9]{sourcecodepro}

% -----------------------------------------------------------------------------
% HTML Conversion

% put this after fonts and before everything else
% \usepackage[latexmk,mathjax]{lwarp}

% Note that MathJax does not work properly at the moment. Math-related macros
% needs to be defined again for MathJax. See section 8.7.6 of the manual.

% -----------------------------------------------------------------------------
% Indices

% put this before `hyperref`
% \usepackage{imakeidx}
% \makeindex[title=Index, intoc=true]

% put this at the end of the document to print the index
% \printindex

% -----------------------------------------------------------------------------
% Links

\usepackage[]{hyperref}
\hypersetup{
    allcolors = violet,
    breaklinks = true,
    colorlinks = true
}

% put this after `hyperref` and `amsmath`, but before theorem environments
\usepackage[capitalize,noabbrev]{cleveref}

% -----------------------------------------------------------------------------
% Proclamation environments

\newtheorem{theorem}{Theorem}[page]

% Starred versions produce unnumbered environments. Many of them are commented
% to avoid confusion, since they are rarely used.

% \newtheorem*{theorem*}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem*{lemma*}{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
% \newtheorem*{corollary*}{Corollary}
\newtheorem*{claim}{Claim}
% \newtheorem*{claim*}{Claim}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
% \newtheorem{definition*}{Definition}
\newtheorem{example}[theorem]{Example}
% \newtheorem*{example*}{Example}
\newtheorem{exercise}[theorem]{Exercise}
% \newtheorem*{exercise*}{Exercise}

\theoremstyle{remark}
\newtheorem*{note}{Note}
\newtheorem*{remark}{Remark}

% \usepackage{enumerate}
% \newenvironment{axioms}{\begin{enumerate}[\bf {Axiom} 1.]}{\end{enumerate}}
% \newenvironment{hypotheses}{
%     \begin{enumerate}[\bf {Hypothesis} 1.]}{\end{enumerate}}

% -----------------------------------------------------------------------------
% Numbering equations, figures, tables, etc.

\numberwithin{equation}{page}
\numberwithin{figure}{page}
\numberwithin{table}{page}

% -----------------------------------------------------------------------------
% Additional math packages

\usepackage{lualatex-math}
\usepackage{physics}

% to label systems of equations
% \usepackage{empheq}

% -----------------------------------------------------------------------------
% Math macros

% to define commands with stars
\usepackage{suffix}

\newcommand{\opn}[1]{\operatorname{#1}}

\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}

\newcommand{\e}{\mathrm{e}}
\newcommand{\ii}{\mathrm{i}}
\newcommand{\ppi}{\mathrm{\pi}}

% from https://tex.stackexchange.com/a/346399
\newcommand{\ol}[1]{\vphantom{#1}\smash{\overline{#1}}}

% There is, as far as I know, no straightforward way to typeset bold math.
% The problem is that font commands in `unicode-math` do not nest. Therefore
% we need different commands for bold upright and bold italic letters.
\newcommand{\mm}[1]{\symbfit{#1}}
\WithSuffix\newcommand\mm*[1]{\symbfup{#1}}
\newcommand{\vv}[1]{\symbfit{#1}}
\WithSuffix\newcommand\vv*[1]{\symbfup{#1}}

% if `unicode-math` is not used
% \newcommand{\mm}[1]{\vb*{#1}}
% \WithSuffix\newcommand\mm*[1]{\vb{#1}}
% \newcommand{\vv}[1]{\vb*{#1}} % use `\renewcommand` if `newpxmath` is used
% \WithSuffix\newcommand\vv*[1]{\vb{#1}}

% -----------------------------------------------------------------------------
% Figures, tables, code listings, etc.

\usepackage[dvipsnames,table]{xcolor}
% The `table` option is necessary for `sgamex`.

% subfigures
% \usepackage{caption}
% \usepackage{subcaption}

% figures
% It is recommended to create separate files for figures.
% \usepackage{tikz}
% \usepackage{pgfplots}
% \pgfplotsset{compat=1.18}

% pseudocode
% \usepackage[noend]{algpseudocode}
% \usepackage{algorithm}

% tables
% \usepackage{tabularray}
% \UseTblrLibrary{booktabs}

% strategic games
% \usepackage{sgamex}
%
% The package is not included in TeX Live and needs to be installed. A
% workaround is needed to use it with `beamer`. See
% https://nick-shm.gitlab.io/notes-snippets/latex/floats/games/

% extensive games (requires LuaLaTeX)
% \usepackage{egameps}
%
% The version in TeX Live is not up-to-date. Install from the author.
% Alternatively, use TikZ for extensive games. See
% https://nick-shm.gitlab.io/notes-snippets/latex/floats/games/

% -----------------------------------------------------------------------------
% Bibliography

% APA
% \usepackage[backend=biber, style=apa]{biblatex}

% Chicago (author-date)
% \usepackage[authordate, backend=biber]{biblatex-chicago}

% add this to the preamble
% \addbibresource{file.bib}

% and print bibliography with this
% \printbibliography[heading=bibintoc]{}

% make `\citeyear` and `\citeyearpar` links (to typeset "name's (year)")
% \DeclareCiteCommand{\citeyear}
% {}{\bibhyperref{\printfield{year}}}{\multicitedelim}{}
% \DeclareCiteCommand{\citeyearpar}
% {}{\mkbibparens{\bibhyperref{\printfield{year}}}}{\multicitedelim}{}

% -----------------------------------------------------------------------------
% Miscellaneous

% make all sections unnumbered
% \setcounter{secnumdepth}{0}

% Chicago-style ellipses
\usepackage{moredefs, lips}
% See https://nick-shm.gitlab.io/notes-snippets/latex/text/ellipses/

% TODO warning for ChkTeX
\newcommand{\todo}[1]{} % chktex 20

% to control spacing
\usepackage{setspace}

% smart quotation marks
\usepackage[maxlevel=4]{csquotes}
